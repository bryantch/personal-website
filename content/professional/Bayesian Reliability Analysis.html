---
title: "Bayesian Reliability Analysis"
author: "Bryant Chen"
date: 2022-01-02
categories: ["Blog"]
tags: ["Simulation", "Bayesian", "Reliability","Mathematical Statistics","MCMC"]
description: Estimating reliability of a serially configured system under a Bayesian analysis.
output:
  pdf_document: default
  html_document: default
---

<script src="Bayesian Reliability Analysis_files/header-attrs/header-attrs.js"></script>


<p><span class="math display">\[f(\pi|x) = \frac{f(x|\pi)f(\pi)}{f(x)} \propto f(x|\pi)f(\pi)\]</span>
<span class="math display">\[X \sim Bin(n,\pi) \rightarrow f(x|\pi) \sim Bin(x;n,\pi)\]</span>
<span class="math display">\[\pi \sim Beta(a,b) \rightarrow f(\pi) = Beta(\pi;a,b)\]</span>
<span class="math display">\[f(\pi|x) \propto f(x|\pi)f(\pi) \rightarrow f(\pi|x) \propto Bin(x;n,\pi)\cdot Beta(\pi;a,b)\]</span>
<span class="math display">\[\rightarrow f(\pi|x) \propto {n \choose x} \frac{1}{B(a,b)}n^{x+a-1}(1-\pi)^{n-x+b-1}\]</span>
For a series system -</p>
<p><span class="math display">\[\pi_s \sim \prod_{c=1}^k \pi_c; \quad \pi_c \sim Beta(a_c,b_c)\]</span> where <span class="math inline">\(s\)</span> and <span class="math inline">\(c\)</span> denote system and component, respectively.</p>
<p><span class="math display">\[\hat{\pi_c} = \frac{n_c - x_c}{n_c}\]</span>
Biasedness of this estimator -</p>
<p><span class="math display">\[E[\hat{\pi_c}] = \frac{n_c - x_c}{n_c} = \frac{E[n_c] - E[x_c]}{n_c} = \frac{n_c}{n_c} - \frac{n_c - x}{(n_c + 1)n_c} = \frac{n^2_c(n_c + 1) - n_c(n_c - x)}{n^2_c(n_c + 1)}\]</span>
<span class="math display">\[= \frac{n^3_c + n^2_c - n^2_c + n_cx_c}{n^2_c(n_c + 1)} = \frac{n^3_c + n_cx_c}{n^2_c(n_c + 1)} = \frac{n_c(n^2_c + x_c)}{n_c(n^2_c + n_c)} = \frac{n^2_c + x_c}{n^2_c + n_c}\]</span></p>
<p>When <span class="math inline">\(x = 0\)</span> or zero failures occur -</p>
<p><span class="math display">\[\pi_c \sim Beta(\pi,1)\]</span>
<span class="math display">\[a = n; \quad b = 1\]</span>
<span class="math display">\[\mu = \frac{a}{a + b} = \frac{n}{n+1}; \quad \sigma^2 = \frac{ab}{(a+b)^2(a+b+1)} = \frac{n}{(n+1)^2(n+2)}\]</span>
Note:</p>
<p><span class="math display">\[Beta(n,1) \rightarrow f(\pi) = \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\pi^{a-1}(1-\pi)^{b-1} \rightarrow f(\pi) = \frac{\Gamma(n+1)}{\Gamma(n)\Gamma(1)}\pi^{n-1}(1-\pi)^0 = n\pi^{n-1}\]</span></p>
<p>When <span class="math inline">\(x &gt; 0\)</span> or at least one failure occurs -</p>
<p><span class="math display">\[\pi_c \sim Beta(n_c - x_c,x_c + 1)\]</span>
<span class="math display">\[a = n-x; \quad b = x + 1\]</span>
<span class="math display">\[\mu = \frac{a}{a + b} = \frac{n-x}{n+1}; \quad \sigma^2 = \frac{ab}{(a+b)^2(a+b+1)} = \frac{(n-x)(x+1)}{(n+1)^2(n+2)}\]</span>
Thus -</p>
<p><span class="math display">\[Beta(\pi_c;n_c-x_c,x_c+1) \rightarrow f(\pi) = \frac{\Gamma(a + b)}{\Gamma(a)\Gamma(b)}\pi^{a-1}(1-\pi)^{b-1} \rightarrow f(\pi)\]</span>
<span class="math display">\[ = \frac{\Gamma(n-x+x+1)}{\Gamma(n-x)\Gamma(x+1)}\pi^{n-x-1}(1-\pi)^{x+1-1} = \frac{\Gamma(n+1)}{\Gamma(n-x)\Gamma(x+1)}\pi^{n-x-1}(1-\pi)^x\]</span>
Then -</p>
<p><span class="math display">\[\pi_s = \prod_{c=1}^k\pi_c; \quad \pi_c \sim Beta(n_c - x_c, x_c + 1)\]</span></p>
<p>Exact Method</p>
<p>Using the Mellin Transformation below to derive the distribution of a product of random variables, specifically Beta random variables -</p>
<p><span class="math display">\[M\{f(x)|s\} = E[X^{s-1}] = \int_0^\infty x^{s-1}f(x)dx\]</span></p>
<p>Approximate Method</p>
<p>This utilizes moments -</p>
<p><span class="math display">\[E[X^{(k)}] = \frac{a+k-1}{a+b+k-1}E[X^{(k-1)}]\]</span>
1st moment -</p>
<p><span class="math display">\[E[X^{(k)}] = \frac{a+k-1}{a+b+k-1}E[X^{(1-1)}] = \frac{a}{a+b}\]</span>
2nd moment -</p>
<p><span class="math display">\[E[X^{(2)}] = \frac{a+2-1}{a+b+2-1}E[X^{(2-1)}] = \frac{a+1}{a+b+1}E[X^{(1)}] = \frac{a+1}{a+b+1}\cdot[\frac{a}{a+b}]\]</span>
Thus -</p>
<p><span class="math display">\[Var[X] = E[X^{(2)}] - (E[X^{(1)}])^2 = \frac{a+1}{a+b+1}\cdot\frac{a}{a+b} - (\frac{a}{a+b})^2 = \frac{ab}{(a+b)^2(a+b+1)}\]</span>
So for <span class="math inline">\(x = 0\)</span>,</p>
<p><span class="math display">\[E[\pi_s^{(1)}] = E\left[\prod_{c=1}^k \pi_c^{(1)}\right] = \prod_{c=1}^k \frac{n_c}{n_c + 1}\]</span>
<span class="math display">\[E[\pi_s^{(2)}] = E\left[\prod_{c=1}^k \pi_c^{(2)}\right] = \prod_{c=1}^k \frac{n_c + 1}{n_c + 1 + 1}E[\pi_s^{(1)}] = E[\pi_s^{(1)}]\prod_{c=1}^k \frac{n_c + 1}{n_c + 2}\]</span>
<span class="math display">\[Var[\pi_s] = E[\pi_s^{(2)}] - (E[\pi_s^{(1)}])^2 = E[\pi_s^{(1)]}]\prod_{c=1}^k\frac{n_c + 1}{n_c + 2} - (E[\pi_s^{(1)}])^2\]</span>
<span class="math display">\[\rightarrow Var[\pi_s] = \prod_{c=1}^k \frac{n_c}{n_c + 1} \cdot\prod_{c=1}^k \frac{n_c + 1}{n_c + 2} - (\prod_{c=1}^k \frac{n_c}{n_c + 1})^2\]</span></p>
<p>And for <span class="math inline">\(x &gt; 0\)</span>,</p>
<p><span class="math display">\[E[\pi_s^{(1)}] = E\left[\prod_{c=1}^k \pi_c^{(1)}\right] = \prod_{c=1}^k \frac{n_c - x_c}{n_c + 1}\]</span>
<span class="math display">\[E[\pi_s^{(2)}] = E\left[\prod_{c=1}^k \pi_c^{(2)}\right] = \prod_{c=1}^k \frac{n_c - x_c + 1}{n_c - x_c + x_c + 1 + 1}E[\pi_s^{(1)}] = E[\pi_s^{(1)}]\prod_{c=1}^k \frac{n_c - x_c + 1}{n_c + 2}\]</span>
<span class="math display">\[Var[\pi_s] = E[\pi_s^{(2)}] - (E[\pi_s^{(1)}])^2 = E[\pi_s^{(1)]}]\prod_{c=1}^k\frac{n_c - x_c + 1}{n_c + 2} - (E[\pi_s^{(1)}])^2\]</span>
<span class="math display">\[\rightarrow Var[\pi_s] = \prod_{c=1}^k \frac{n_c-x_c}{n_c + 1} \cdot\prod_{c=1}^k \frac{n_c - x_c + 1}{n_c + 2} - (\prod_{c=1}^k \frac{n_c - x_c}{n_c + 1})^2\]</span>
System reliabiltiy is approximated by a <span class="math inline">\(Beta(a_s,b_s)\)</span> distribution as a posterior distribution with parameters <span class="math inline">\(a_s\)</span> and <span class="math inline">\(b_s\)</span> with a mean and variance of -</p>
<p><span class="math display">\[\mu = \frac{a_s}{a_s + b_s}; \quad \sigma^2 = \frac{a_sb_s}{(a_s + b_s)^2(a_s + b_s + 1)}\]</span>
Rearranging for <span class="math inline">\(a_s\)</span> and <span class="math inline">\(b_s\)</span>, we obtain -</p>
<p><span class="math display">\[b_s = \frac{\hat{\mu}(-\hat{\mu} + 1)^2}{\hat{\sigma^2}} + \hat{\mu} - 1; a_s = \frac{\hat{\mu}b}{1-\hat{\mu}}\]</span> where <span class="math display">\[\hat{\mu} = \prod_{i=1}^c \frac{n_c - x_c}{n_c + 1}\]</span> and</p>
<p><span class="math display">\[\hat{\sigma^2} = \hat{\mu}\prod_{c=1}^k \frac{n_c - x_c + 1}{n_c + 2} - \hat{\mu}^2\]</span></p>
<p>The expression for the system parameter estimates uses the individual component test results to generate the system reliability’s probability distribution. This is the general case above so it works for components with failures and components with no failures configured serially.</p>
<p><strong>Simulation (Bootstrap)</strong></p>
<p>Here is code I’ve written to obtain the standard error of system reliability based on component reliabilities via sampling/bootstrapping. It is also possible to bootstrap the power for sample size calculations -</p>
<p><strong>References</strong></p>
<ol style="list-style-type: decimal">
<li>The Distribution of Products of Beta, Gamma and Gaussian Random Variables</li>
<li>Reliability Estimation of One-Shot Systems with Zero Component Test Failures</li>
</ol>
